# --- Ù…Ø±Ø­Ù„Ù‡ Û±: Ù†ØµØ¨ Ùˆ Ø§Ø¬Ø±Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø§ÙˆÙ„Ø§Ù…Ø§ ---
import os
import time

print("â³ Ø¯Ø± Ø­Ø§Ù„ Ù†ØµØ¨ Ø§ÙˆÙ„Ø§Ù…Ø§ Ø¯Ø± Ù…Ø­ÛŒØ· Ú©ÙˆÙ„Ø¨...")
# Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ Ø§Ø¬Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù†ØµØ¨ Ø±Ø³Ù…ÛŒ Ø§ÙˆÙ„Ø§Ù…Ø§
!curl -fsSL https://ollama.com/install.sh | sh
print("âœ… Ø§ÙˆÙ„Ø§Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù†ØµØ¨ Ø´Ø¯.")

# Ø§Ø¬Ø±Ø§ÛŒ Ø³Ø±ÙˆØ± Ø§ÙˆÙ„Ø§Ù…Ø§ Ø¯Ø± Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
!ollama serve &

# Ú©Ù…ÛŒ ØµØ¨Ø± Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù…Ù„ Ø³Ø±ÙˆØ±
print("â³ Ù…Ù†ØªØ¸Ø± Ø¨Ù…Ø§Ù†ÛŒØ¯ ØªØ§ Ø³Ø±ÙˆØ± Ø§ÙˆÙ„Ø§Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ø´ÙˆØ¯...")
time.sleep(10)
print("âœ… Ø³Ø±ÙˆØ± Ø§ÙˆÙ„Ø§Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª.")


# --- Ù…Ø±Ø­Ù„Ù‡ Û²: ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ØµÙ„ÛŒ Ùˆ Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„ Ø´Ø¯Ù‡ ---
base_dir = "/content/drive/MyDrive/AI_Offline_Toolkit_Final"
os.makedirs(base_dir, exist_ok=True)

# === Ù„ÛŒØ³Øª Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ PyPI ===
python_libraries = list(set([
    # Core AI & Deep Learning
    "torch", "torchvision", "torchaudio", "tensorflow", "scikit-learn", "jax", "jaxlib",
    "pandas", "numpy", "matplotlib", "seaborn",
    # Text & NLP
    "transformers", "langchain", "langchain-community", "sentence-transformers", 
    "nltk", "spacy", "gensim", "hazm", "beautifulsoup4", "scrapy",
    "chromadb", "faiss-cpu", "llama-cpp-python", "PyMuPDF",
    # Image Processing
    "opencv-python-headless", "scikit-image", "Pillow", "timm", "albumentations", "fiftyone", "pdf2image",
    # Audio Processing
    "librosa", "pydub", "soundfile", "speechrecognition", "pyannote.audio",
    # MLOps & Utilities
    "mlflow", "wandb", "optuna", "fastapi", "uvicorn", "gradio", "streamlit", "tqdm", "jupyter", "PyYAML",
    # Quantization & Performance
    "bitsandbytes", "accelerate", "vllm", "optimum", "auto-gptq"
]))

# === Ù„ÛŒØ³Øª Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ (Ollama) ===
models_to_pull = [
    "llama3", "qwen2:7b", "mistral", "gemma:7b", "command-r", "codestral", "deepseek-coder"
]

# === Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ GitHub ===
github_repos_to_clone = {
    "ai_student_assistant": "https://github.com/alimoazzam123/ai-student-assistant.git",
    "llama_cpp": "https://github.com/ggerganov/llama.cpp.git",
    "text_generation_webui": "https://github.com/oobabooga/text-generation-webui.git",
    "ollama": "https://github.com/ollama/ollama.git",
    "open_webui": "https://github.com/open-webui/open-webui.git",
    "v2ray_core": "https://github.com/v2ray/v2ray-core.git",
    "nekoray": "https://github.com/MatsuriDayo/nekoray.git",
    "proxychains_ng": "https://github.com/rofl0r/proxychains-ng.git",
    "tor": "https://github.com/torproject/tor.git",
    "opnsense_core": "https://github.com/opnsense/core.git"
}


# --- Ù…Ø±Ø­Ù„Ù‡ Û³: Ø³Ø§Ø®Øª Ù¾ÙˆØ´Ù‡â€ŒÙ‡Ø§ Ùˆ Ø´Ø±ÙˆØ¹ Ø¯Ø§Ù†Ù„ÙˆØ¯ ---
pypi_dir = os.path.join(base_dir, "PyPI_Libraries")
models_dir = os.path.join(base_dir, "Ollama_Models_and_App")
github_dir = os.path.join(base_dir, "GitHub_Projects")

os.makedirs(pypi_dir, exist_ok=True); os.makedirs(models_dir, exist_ok=True); os.makedirs(github_dir, exist_ok=True)
print(f"\nØ³Ø§Ø®ØªØ§Ø± Ù¾ÙˆØ´Ù‡ Ø¯Ø± Ù…Ø³ÛŒØ± {base_dir} Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯.")

# Û±. Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ PyPI
print("\nâ³ Ø´Ø±ÙˆØ¹ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ PyPI...")
requirements_path = "/content/requirements.txt"
with open(requirements_path, "w") as f: f.write("\n".join(python_libraries))
!pip download --no-deps -r {requirements_path} -d {pypi_dir}
print("âœ… Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ PyPI ØªÙ…Ø§Ù… Ø´Ø¯.")

# Û². Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§ÙˆÙ„Ø§Ù…Ø§ Ùˆ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ø¢Ù†
print("\nâ³ Ø´Ø±ÙˆØ¹ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¯Ù„â€ŒÙ‡Ø§ Ø¨Ø§ Ø§ÙˆÙ„Ø§Ù…Ø§...")
for model in models_to_pull:
    print(f"\n--- ğŸ“¥ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¯Ù„: {model} ---")
    !ollama pull {model}
print("âœ… Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„Ø§Ù…Ø§ ØªÙ…Ø§Ù… Ø´Ø¯.")

# Û³. Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨
print("\nâ³ Ø´Ø±ÙˆØ¹ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨...")
for name, url in github_repos_to_clone.items():
    try:
        target_path = os.path.join(github_dir, name)
        if not os.path.exists(target_path):
            print(f"--- Ø¯Ø± Ø­Ø§Ù„ Ú©Ù„ÙˆÙ† Ú©Ø±Ø¯Ù† Ù¾Ø±ÙˆÚ˜Ù‡: {name} ---")
            !git clone {url} {target_path}
        else:
            print(f"--- Ù¾ÙˆØ´Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡ {name} Ø§Ø² Ù‚Ø¨Ù„ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯. Ø§Ø² Ú©Ù„ÙˆÙ† Ú©Ø±Ø¯Ù† ØµØ±Ù Ù†Ø¸Ø± Ø´Ø¯. ---")
    except Exception as e:
        print(f"âŒ Ø®Ø·Ø§ÛŒÛŒ Ø¯Ø± Ú©Ù„ÙˆÙ† Ú©Ø±Ø¯Ù† Ù¾Ø±ÙˆÚ˜Ù‡ {name} Ø±Ø® Ø¯Ø§Ø¯: {e}")
print("âœ… Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ ØªÙ…Ø§Ù… Ø´Ø¯.")


# --- Ù…Ø±Ø­Ù„Ù‡ Û´: Ø¢Ø±Ø´ÛŒÙˆ Ú©Ø±Ø¯Ù† Ú©Ù„ Ù¾Ú©ÛŒØ¬ ---
print("\n" + "="*50)
print("â³ Ø¯Ø± Ø­Ø§Ù„ Ø¢Ø±Ø´ÛŒÙˆ Ú©Ø±Ø¯Ù† Ø§ÙˆÙ„Ø§Ù…Ø§ Ùˆ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ø¢Ù† Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„...")
print("="*50)

# Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú¯ÙˆÚ¯Ù„ Ø¯Ø±Ø§ÛŒÙˆ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ ÙØ§ÛŒÙ„ Ù†Ù‡Ø§ÛŒÛŒ
from google.colab import drive
drive.mount('/content/drive')

# ØªØ¹Ø±ÛŒÙ Ù†Ø§Ù… Ùˆ Ù…Ø³ÛŒØ± ÙØ§ÛŒÙ„ Ø®Ø±ÙˆØ¬ÛŒ
archive_path = f"/content/drive/MyDrive/Ollama_Offline_Package_Complete.tar.gz"

# ÙØ´Ø±Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙØ§ÛŒÙ„ Ø§Ø¬Ø±Ø§ÛŒÛŒ Ø§ÙˆÙ„Ø§Ù…Ø§ Ùˆ Ù¾ÙˆØ´Ù‡ Ù…Ø¯Ù„â€ŒÙ‡Ø§
!tar -czf {archive_path} /usr/local/bin/ollama /root/.ollama
print(f"âœ… Ù¾Ú©ÛŒØ¬ Ø§ÙˆÙ„Ø§Ù…Ø§ Ø¯Ø± ÙØ§ÛŒÙ„ {archive_path} Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.")

print("\n\nğŸ‰ğŸ‰ğŸ‰ ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÛŒØ§Øª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯. ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ùˆ Ø¢Ø±Ø´ÛŒÙˆÙ‡Ø§ Ø¯Ø± Ú¯ÙˆÚ¯Ù„ Ø¯Ø±Ø§ÛŒÙˆ Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯. ğŸ‰ğŸ‰ğŸ‰")
